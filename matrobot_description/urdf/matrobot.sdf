<?xml version="1.0" ?>
<sdf version="1.6">
  <model name="matrobot">
    <static>false</static>
    <link name="base_link">
      <inertial>
        <mass>120.47</mass>
        <inertia>
          <ixx>0.01984</ixx>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyy>0.08017</iyy>
          <iyz>0.0</iyz>
          <izz>0.08074</izz>
        </inertia>
      </inertial>
      <visual name="visual_base_link">
        <geometry>
          <mesh>
            <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/base_link.STL</uri>
          </mesh> 
        </geometry>
        <material>
          <ambient>0.0 0.0 0.0 1</ambient>
          <diffuse>0.0 0.0 0.0 1</diffuse>
        </material>
      </visual>
      <collision name="collision_base_link">
        <pose>0 0 0 0 0 0</pose>
        <geometry>
          <box>
            <size> 0.92 0.35 0.34</size>
          </box>
        </geometry>
        </surface>
      </collision>
    </link>
  
    <!-- Ön Sol Tekerlek -->
    <link name="left_front_wheel_link">
      <pose>0 0 0 0 0 0</pose>
      <inertial>
        <mass>10.983</mass>
        <pose>0.32 0.245 -0.11 0 0 0</pose>
        <inertia>
          <ixx>0.119</ixx>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyy>0.220</iyy>
          <iyz>0.0</iyz>
          <izz>0.119</izz>
        </inertia>
      </inertial>
      <visual name="visual_left_front">
        <pose>0.32 0.245 -0.11 0 0 0</pose>
        <geometry>
          <mesh>
            <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/LFW.STL</uri>
          </mesh>
        </geometry>
        <material>
          <ambient>0.79216 0.0 0.0 1</ambient>
          <diffuse>0.79216 0.0 0.0 1</diffuse>
        </material>
      </visual>
      <collision name="collision_left_front">
        <pose>0.32 0.245 -0.11 1.5708 0 0</pose>
        <geometry>
          <cylinder>
            <radius>0.2</radius>
            <length>0.1</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>2</mu>
              <mu2>2</mu2>
            </ode>
          </friction>
          <bounce>
            <restitution_coefficient>0.0</restitution_coefficient>
            <threshold>0.0</threshold>
          </bounce>
      </collision>
    </link>

    <!-- Ön Sağ Tekerlek -->
    <link name="right_front_wheel_link">
      <inertial>
        <mass>10.983</mass>
        <pose>0.32 -0.245 -0.11 0 0 0</pose>
        <inertia>
          <ixx>0.119</ixx>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyy>0.220</iyy>
          <iyz>0.0</iyz>
          <izz>0.119</izz>
        </inertia>
      </inertial>
      <visual name="visual_right_front">
        <pose>0.32 -0.245 -0.11 0 0 0</pose>
        <geometry>
          <mesh>
            <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/RFW.STL</uri>
          </mesh>
        </geometry>
        <material>
          <ambient>0.79216 0.0 0.0 1</ambient>
          <diffuse>0.79216 0.0 0.0 1</diffuse>
        </material>
      </visual>
      <collision name="collision_right_front">
        <pose>0.32 -0.245 -0.11 1.5708 0 0</pose>
        <geometry>
          <cylinder>
            <radius>0.2</radius>
            <length>0.1</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>2</mu>
              <mu2>2</mu2>
            </ode>
          </friction>
          <bounce>
            <restitution_coefficient>0.0</restitution_coefficient>
            <threshold>0.0</threshold>
          </bounce>
      </collision>
    </link>

    <!-- Arka Sol Tekerlek -->
    <link name="left_back_wheel_link">
      <inertial>
        <mass>10.983</mass>
        <pose>-0.28 0.245 -0.11 0 0 0</pose>
        <inertia>
          <ixx>0.1190</ixx>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyy>0.2197</iyy>
          <iyz>0.0</iyz>
          <izz>0.1190</izz>
        </inertia>
      </inertial>
      <visual name="visual_left_back">
        <pose>-0.28 0.245 -0.11 0 0 0</pose>
        <geometry>
          <mesh>
            <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/LBW.STL</uri>
          </mesh>
        </geometry>
        <material>
          <ambient>0.79216 0.0 0.0 1</ambient>
          <diffuse>0.79216 0.0 0.0 1</diffuse>
        </material>
      </visual>
      <collision name="collision_left_back">
        <pose>-0.28 0.245 -0.11 1.5708 0 0</pose>
        <geometry>
          <cylinder>
            <radius>0.2</radius>
            <length>0.1</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>2</mu>
              <mu2>2</mu2>
            </ode>
          </friction>
          <bounce>
            <restitution_coefficient>0.0</restitution_coefficient>
            <threshold>0.0</threshold>
          </bounce>
        </surface>
      </collision>
    </link>

    <!-- Arka Sağ Tekerlek -->
    <link name="right_back_wheel_link">
      <inertial>
        <mass>10.983</mass>
        <pose>-0.28 -0.245 -0.11 0 0 0</pose>
        <inertia>
          <ixx>0.1190</ixx>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyy>0.2197</iyy>
          <iyz>0.0</iyz>
          <izz>0.1190</izz>
        </inertia>
      </inertial>
      <visual name="visual_right_back">
        <pose>-0.28 -0.245 -0.11 0 0 0</pose>
        <geometry>
          <mesh>
            <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/RBW.STL</uri>
          </mesh>
        </geometry>
        <material>
          <ambient>0.79216 0.0 0.0 1</ambient>
          <diffuse>0.79216 0.0 0.0 1</diffuse>
        </material>
      </visual>
      <collision name="collision_right_back">
        <pose>-0.28 -0.245 -0.11 1.5708 0 0</pose>
        <geometry>
          <cylinder>
            <radius>0.2</radius>
            <length>0.1</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>2</mu>
              <mu2>2</mu2>
            </ode>
          </friction>
          <bounce>
            <restitution_coefficient>0.0</restitution_coefficient>
            <threshold>0.0</threshold>
          </bounce>
      </collision>
    </link>
    
    <link name="LIDAR_Link">
        <inertial>
            <mass>0.1152</mass>
            <pose>0.51415 -0.0048129 0.089587 0 0 0</pose>
            <inertia>
                <ixx>0.00015477</ixx>
                <ixy>0.0</ixy>
                <ixz>0.0</ixz>
                <iyy>0.00015477</iyy>
                <iyz>0.0</iyz>
                <izz>0.0000922</izz>
            </inertia>
        </inertial>
        <visual name="lidar_visual">
            <pose>0.51415 -0.0048129 0.089587 0 0 0</pose>
            <geometry>
                <mesh>
                <uri>file:///home/okan/matro_ws/src/matrobot_ros2/matrobot_description/meshes/LIDAR.STL</uri>
                </mesh>
            </geometry>
            <material>
                <ambient>0.75294 0.75294 0.75294 1</ambient>
                <diffuse>0.75294 0.75294 0.75294 1</diffuse>
            </material>
        </visual>
        <collision name="lidar_collision">
            <pose>0.51415 -0.0048129 0.089587 0 1.5708 0</pose>
             <geometry>
                <cylinder>
                <radius>0.04</radius>
                <length>0.04</length>
                </cylinder>
            </geometry>
        </collision>
        <sensor name="RPLIDAR" type="gpu_lidar">
            <gz_frame_id>LIDAR_Link</gz_frame_id>
            <update_rate>10</update_rate>
            <topic>/laser_scan</topic>
            <lidar>
                <scan>
                <horizontal>
                    <samples>640</samples>
                    <resolution>1</resolution>
                    <min_angle>-3.14</min_angle>
                    <max_angle>3.14</max_angle>
                </horizontal>
                <vertical>
                    <samples>360</samples>
                    <resolution>0.1</resolution>
                    <min_angle>0.0</min_angle>
                    <max_angle>0.0</max_angle>
                </vertical>
                </scan>
                <range>
                <min>1.0</min>
                <max>10.0</max>
                <resolution>0.01</resolution>
                </range>
            </lidar>
            <visualize>true</visualize>
            <always_on>1</always_on> 
        </sensor>
    </link>

    <link name="imu_link">
      <pose>0 0 0 0 0 0</pose>
      <sensor name="imu" type="imu">
        <always_on>1</always_on>
        <update_rate>100</update_rate>
        <visualize>true</visualize>
        <topic>/imu</topic>
        <enable_metrics>true</enable_metrics>
        <gz_frame_id>imu_link</gz_frame_id>
      </sensor>
    </link>       
    
    <joint name="LIDAR_Joint" type="fixed">
        <pose>0.51415 -0.0048129 0.089587 0 0 0</pose>
        <parent>base_link</parent>
	    <child>LIDAR_Link</child>
	</joint>
    
    <joint name="imu_joint" type="fixed">
        <pose>0 0 0 0 0 0</pose>
        <parent>base_link</parent>
        <child>imu_link</child>
    </joint>

    <!-- Wheel Joints -->
    <joint name="left_front_wheel_joint" type="revolute">
        <pose>0.32 0.245 -0.11 0 0 0</pose>
        <parent>base_link</parent>
        <child>left_front_wheel_link</child>
        <axis>
            <xyz expressed_in='left_front_wheel_link'>0 1 0</xyz>
            <limit>
                <lower>-1.79769e+308</lower>
                <upper>1.79769e+308</upper>
                <effort>5</effort>        
                <velocity>24</velocity>     
            </limit>
        </axis>
    </joint>

    <joint name="right_front_wheel_joint" type="revolute">
        <pose>0.32 -0.245 -0.11 0 0 0</pose>
        <parent>base_link</parent>
        <child>right_front_wheel_link</child>
        <axis>
            <xyz expressed_in='right_front_wheel_link'>0 1 0</xyz>
            <limit>
                <lower>-1.79769e+308</lower>
                <upper>1.79769e+308</upper>
                <effort>5</effort>        
                <velocity>24</velocity>     
            </limit>
        </axis>
    </joint>

    <joint name="left_back_wheel_joint" type="revolute">
        <pose>-0.28 0.245 -0.11 0 0 0</pose>
        <parent>base_link</parent>
        <child>left_back_wheel_link</child>
        <axis>
            <xyz expressed_in='left_back_wheel_link'>0 1 0</xyz>
            <limit>
                <lower>-1.79769e+308</lower>
                <upper>1.79769e+308</upper>
                <effort>5</effort>        
                <velocity>24</velocity>     
            </limit>
        </axis>
    </joint>

    <joint name="right_back_wheel_joint" type="revolute">
        <pose>-0.28 -0.245 -0.11 0 0 0</pose>
        <parent>base_link</parent>
        <child>right_back_wheel_link</child>
        <axis>
            <xyz expressed_in='right_back_wheel_link'>0 1 0</xyz>
            <limit>
                <lower>-1.79769e+308</lower>
                <upper>1.79769e+308</upper>
                <effort>5</effort>        
                <velocity>24</velocity>     
            </limit>
        </axis>
    </joint>

  	<plugin
        filename="gz-sim-diff-drive-system"
        name="gz::sim::systems::DiffDrive">
        <update_rate>100</update_rate>
        <left_joint>left_front_wheel_joint</left_joint>
        <left_joint>left_back_wheel_joint</left_joint>
        <right_joint>right_front_wheel_joint</right_joint>
        <right_joint>right_back_wheel_joint</right_joint>
        <wheel_separation>0.39</wheel_separation>
        <wheel_radius>0.4</wheel_radius>
        <odom_publish_frequency>100</odom_publish_frequency>
        <publish_tf>true</publish_tf>
        <frame_id>odom</frame_id>
        <child_frame_id>base_link</child_frame_id>
        <tf_topic>/tf</tf_topic>
        <odom_topic>/odom</odom_topic>
        <topic>/cmd_vel</topic>
    </plugin>
    <plugin
        filename="gz-sim-joint-state-publisher-system"
        name="gz::sim::systems::JointStatePublisher">
        <topic>/joint_states</topic>
    </plugin>
    <plugin
        filename="gz-sim-pose-publisher-system"
        name="gz::sim::systems::PosePublisher">
        <publish_link_pose>true</publish_link_pose>
        <use_pose_vector_msg>true</use_pose_vector_msg>
        <static_publisher>true</static_publisher>
        <static_update_frequency>1</static_update_frequency>
    </plugin>
    <plugin
        filename="gz-sim-odometry-publisher-system"
        name="gz::sim::systems::OdometryPublisher">
        <odom_frame>odom</odom_frame>
        <robot_base_frame>base_link</robot_base_frame>
        <odom_publish_frequency>100</odom_publish_frequency>
        <odom_topic>/odom</odom_topic>
        <tf_topic>tf</tf_topic>
    </plugin>
  </model>
</sdf>

